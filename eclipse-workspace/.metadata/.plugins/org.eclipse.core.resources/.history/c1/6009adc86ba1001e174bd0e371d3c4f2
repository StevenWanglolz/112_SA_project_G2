package controller;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.json.JSONObject;

import app.PostHelper;
import tools.JsonReader;
import javax.servlet.ServletException;
import javax.servlet.annotation.MultipartConfig;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.json.JSONObject;

import app.PostHelper;
import tools.JsonReader;

/**
 * Servlet implementation class SearchController2
 */
@WebServlet("/SearchController2")
//@MultipartConfig 
// Steven copied the above line


public class SearchController2 extends HttpServlet {
    private static final long serialVersionUID = 1L;

    private PostHelper ph = PostHelper.getHelper();

    public SearchController2() {
        super();
    }

    protected void doGet(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        JsonReader jsr = new JsonReader(request);

        JSONObject jso = jsr.getObject();

		String searchTerm = jso.getString("keyword");
		
		System.out.println(searchTerm);

        if (searchTerm != null && !searchTerm.isEmpty()) {
            JSONObject query = ph.getSearchPost(searchTerm);

            JSONObject resp = new JSONObject();
            resp.put("status", "200");
            resp.put("message", "Search successful");
            resp.put("response", query);

            jsr.response(resp, response);
        } else {
            JSONObject resp = new JSONObject();
            resp.put("status", "400");
            resp.put("message", "Invalid search term");

            jsr.response(resp, response);
        }
    }

    protected void doPost(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {
        // Your existing doPost method logic for handling post creation can remain here
        // ...
    }
}
